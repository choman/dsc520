---
title: "ASSIGNMENT 7.2"
author: "Chad Homan"
date: '2021-04-27'
output:
  pdf_document: default
  html_document: default
  word_document: default
bibliography: bibliography.bib
---

```{r setup, echo=FALSE}
workdir <- system("git rev-parse --show-toplevel", intern=TRUE)
knitr::opts_knit$set(root.dir = workdir) 
survey_df <- read.csv("student-survey.csv")
```

# Abstract

As a data science intern with newly learned knowledge in skills in statistical correlation and R programming, you will analyze the results of a survey recently given to college students. You learn that the research question being 
investigated is: “Is there a significant relationship between the amount of time spent reading and the time spent watching television?” You are also interested 
if there are other significant relationships that can be discovered? The survey 
data is located in this StudentSurvey.csv file.

## Covariance

Use R to calculate the covariance of the Survey variables and provide an 
explanation of why you would use this calculation and what the results indicate.

Answer: Covariance is a statistical calculation that helps you understand how two sets of data are related to each other [@wiki2020]. In other words, it defines 
the changes between the two variables. The covariance of the survey data is below:

```{r survey}
cov(survey_df)
```
I would interpret this data to mean that there is a strong correlation between 
these variables. However, there is not a strong correlation when comparing any 
of the variables against gender. 

## Survey Data Examination

1. Examine the Survey data variables.

There are four variables in the set of data

```{r variables, echo=FALSE}
mypackages <- c("ggplot2", "pastecs", "dplyr", "purrr", 
                "GGally", "reshape2", "scales")

not_installed <- mypackages[!(mypackages %in% installed.packages()[, "Package"])]
if(length(not_installed)) install.packages(not_installed)

# Load libraries
##lapply(mypackages, require, character.only=TRUE)
for (package in mypackages) {
  library(package, character.only=TRUE)
}

#install.packages("GGally")
##library(pastecs)
#library(ggplot2)
#library(dplyr)
#library(purrr)

#library(pastecs)
#library(ggplot2)
#library(dplyr)
#library(purrr)

colnames(survey_df)

info <- function(df)
{
  print(summary(df))
  print(stat.desc(df))
}

print ("Statistic Info for: survey_df")
info(survey_df)

genderA <- survey_df[ which(survey_df$Gender == 0), ]
genderB <- survey_df[ which(survey_df$Gender == 1), ]

print ("Statistic Info for: genferA")
info(genderA)

print ("Statistic Info for: genderB")
info(genderB)

ggplot(data=survey_df, aes(x=TimeReading, y=TimeTV, group=1)) +
  geom_line(aes(y=TimeTV, color = "Both")) + 
  geom_line(data=genderA, aes(y=TimeTV, color = "GenderA")) +
  geom_line(data=genderB, aes(y=TimeTV, color = "GenderB")) +
  scale_color_manual("", 
       breaks = c("Both", "GenderA", "GenderB"),
       values = c("darkred", "darkgreen", "steelblue")) +
  xlab("Time Reading") + ylab("Time TV")
                  
  
            
```

`* TimeReading
* TimeTV


What measurement is being used for the 
variables? Explain what effect changing the measurement being used for the 
variables would have on the covariance calculation. Would this be a problem?
Explain and provide a better alternative if needed.

## Corellation

Choose the type of correlation test to perform, explain why you chose this test,
and make a prediction if the test yields a positive or negative correlation?

### Perform a correlation analysis of:

#### All variables

* **Pearson Method**:

```{r correlation-p, echo =FALSE}
cor(survey_df)
pearson <- cor(survey_df)
GGally::ggpairs(survey_df)

```

* Kendall Method:

```{r correlation-k, echo =FALSE}
cor(survey_df, method ="kendall")
kendall <- cor(survey_df, method ="kendall")
```

* Spearman Method:

```{r correlation0s, echo =FALSE}
cor(survey_df, method ="spearman")
spearman <- cor(survey_df, method ="spearman")
```

* Spearman > Peason
```{r sp-compare, echo=FALSE}
spearman > pearson
```

Doing both is interesting because if you have S > P, that means that you have a correlation that is monotonic but not linear [@stack2010]. Therefore I believe
pearson is a better selection 

#### A single correlation between two a pair of the variables

```{r correlation2, echo =FALSE}
cor(survey_df$TimeTV, survey_df$TimeReading)
```

#### Repeat your correlation test in step 2 but set the confidence interval at 99%

```{r correlation3, echo =FALSE}
cor.test(survey_df$TimeTV, survey_df$TimeReading, conf.level = 0.99)
```

#### Describe what the calculations in the correlation matrix suggest about the relationship between the variables. Be specific with your explanation.


## Calculate the correlation coefficient and the coefficient of determination, describe what you conclude about the results.

## Analysis: TV vs Reading

Based on your analysis can you say that watching more TV caused students to read less? Explain.

## Partial Correlation

Pick three variables and perform a partial correlation, documenting which variable you are “controlling”. Explain how this changes your interpretation and explanation of the results.


# References

