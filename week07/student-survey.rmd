---
title: "ASSIGNMENT 7.2"
author: "Chad Homan"
date: '2021-04-27'
output:
  pdf_document: default
  html_document: default
  word_document: default
---

```{r setup, echo=FALSE}
workdir <- system("git rev-parse --show-toplevel", intern=TRUE)
knitr::opts_knit$set(root.dir = workdir) 
survey_df <- read.csv("student-survey.csv")
```

# Abstract

As a data science intern with newly learned knowledge in skills in statistical correlation and R programming, you will analyze the results of a survey recently given to college students. You learn that the research question being 
investigated is: “Is there a significant relationship between the amount of time spent reading and the time spent watching television?” You are also interested 
if there are other significant relationships that can be discovered? The survey 
data is located in this StudentSurvey.csv file.

## Covariance

Use R to calculate the covariance of the Survey variables and provide an 
explanation of why you would use this calculation and what the results indicate.
```{r survey}
summary(survey_df)
```

## Survey Data Examination

1. Examine the Survey data variables.

There are four variables in the set of data

```{r variables}
colnames(survey_df)
mean(survey_df$TimeReading)
mean(survey_df$TimeTV)
mean(survey_df$Happiness)
```

`* TimeReading
* TimeTV


What measurement is being used for the 
variables? Explain what effect changing the measurement being used for the 
variables would have on the covariance calculation. Would this be a problem?
Explain and provide a better alternative if needed.

## Corellation

Choose the type of correlation test to perform, explain why you chose this test,
and make a prediction if the test yields a positive or negative correlation?

### Perform a correlation analysis of:

#### All variables
#### A single correlation between two a pair of the variables
#### Repeat your correlation test in step 2 but set the confidence interval at 99%
#### Describe what the calculations in the correlation matrix suggest about the relationship between the variables. Be specific with your explanation.


## Calculate the correlation coefficient and the coefficient of determination, describe what you conclude about the results.

## Based on your analysis can you say that watching more TV caused students to read less? Explain.

## Pick three variables and perform a partial correlation, documenting which variable you are “controlling”. Explain how this changes your interpretation and explanation of the results.

# Inline Code
```{r load-stuff, include=FALSE}
library(ggplot2)
library(dplyr)
library(purrr)

# set theme
theme_set(theme_minimal())

tmp <- getwd()
setwd(workdir)
heights_df <- read.csv("data/r4ds/heights.csv")

covid_dir <- "data/nytimes/covid-19-data"
covid_counties_df <- read.csv(file.path(covid_dir, "us-counties.csv")) 
covid_us_df <- read.csv(file.path(covid_dir, "us.csv"))
covid_df <- read.csv(file.path(covid_dir, "us-states.csv"))

covid_df$date <- as.Date(covid_df$date,"%Y-%m-%d")


florida_df <- covid_df %>% filter(state == "Florida")
ny_df <- covid_df %>% filter(state == "New York")
california_df <- covid_df %>% filter(state == "California")


#heights_df
setwd(tmp)
```

## NY Times COVID-19 Data
```{r line-plot-covid, echo=FALSE}
# Need code
ggplot(data=florida_df, aes(x=date, group=1, nrow=7, ncol=7)) +
  geom_line(aes(y = cases, color = "Florida")) +
  geom_line(data=ny_df, aes(y = cases, color="New York")) +
  geom_line(data=california_df, aes(y = cases, color="California")) +
  scale_color_manual("",
        breaks = c("Florida", "New York", "California"),
        values = c("darkred", "darkgreen", "steelblue")) +
  xlab(" ") + ylab("Cases") + scale_y_log10()

```

## R4DS Height vs Earnings
```{r plot-heights-vd-earnings, echo=FALSE}
ggplot(heights_df, aes(x=height, y=earn, col=sex)) + 
  geom_point() +   
  xlab("Height (Inches)") + 
  ylab("Earnings (Dollars)")

```

# Tables

## Knitr Table with Kable
```{r show-full-table, results='asis', echo=FALSE}
library(knitr)

convert_bool <-function(df)
{
  df <- ifelse(df == TRUE, "Yes", "No")
  return(df)
}

name <- c("Aragon", "Bilbo", "Frodo", "Galadriel", 
          "Sam", "Gandalf", "Legolas", "Sauron", "Gollum")
race <- c("Men", "Hobbit", "Hobbit", "Elf", "Hobbit", 
          "Maia", "Elf", "Maia", "Hobbit")
in_fellowship <- c(TRUE, FALSE, TRUE, FALSE, 
                   TRUE, TRUE, TRUE, FALSE, FALSE)
ring_bearer <- c(FALSE, TRUE, TRUE, FALSE, TRUE, 
                 TRUE, FALSE, TRUE, TRUE)
age <- c(88, 129, 51, 7000, 36, 2019, 2931, 7052, 589)

in_fellowship <- convert_bool(in_fellowship)
ring_bearer <- convert_bool(ring_bearer)

characters_df <- data.frame(name, race, in_fellowship, ring_bearer, age)
col_names = c("Name", "Race", "In Fellowship?", "Is Ring Bearer?", "Age")
kable(characters_df, 
      caption="One Ring To Rule Them All",
      col.names = col_names,
      format="pandoc",
      align="llccr",
      padding=2, 
      table.attr = "style='pandoc_grid_table'")
```

## Pandoc Table
```{r show-table, results='asis', echo=FALSE}
kable(head(filter(characters_df, nchar(name) <= 6), n=5),
      caption="One Ring To Rule Them All",
      col.names = col_names,
      format="pandoc",
      align="llccr",
      padding=2, 
      table.attr = "style='pandoc_grid_table'")
```

# References

